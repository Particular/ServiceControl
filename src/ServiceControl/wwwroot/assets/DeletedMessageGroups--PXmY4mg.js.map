{"version":3,"file":"DeletedMessageGroups--PXmY4mg.js","sources":["../../../../frontend/src/components/failedmessages/DeletedMessageGroups.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onMounted, onUnmounted, ref } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport { useShowToast } from \"../../composables/toast\";\nimport createMessageGroupClient from \"./messageGroupClient\";\nimport { useCookies } from \"vue3-cookies\";\nimport NoData from \"../NoData.vue\";\nimport TimeSince from \"../TimeSince.vue\";\nimport LicenseNotExpired from \"../../components/LicenseNotExpired.vue\";\nimport ServiceControlAvailable from \"../ServiceControlAvailable.vue\";\nimport ConfirmDialog from \"../ConfirmDialog.vue\";\nimport routeLinks from \"@/router/routeLinks\";\nimport FailureGroupView from \"@/resources/FailureGroupView\";\nimport { TYPE } from \"vue-toastification\";\nimport MetadataItem from \"@/components/MetadataItem.vue\";\nimport ActionButton from \"@/components/ActionButton.vue\";\nimport { faArrowRotateRight, faEnvelope } from \"@fortawesome/free-solid-svg-icons\";\nimport { faClock } from \"@fortawesome/free-regular-svg-icons\";\nimport { useServiceControlStore } from \"@/stores/ServiceControlStore\";\n\nconst statusesForRestoreOperation = [\"restorestarted\", \"restoreprogressing\", \"restorefinalizing\", \"restorecompleted\"] as const;\ntype RestoreOperationStatus = (typeof statusesForRestoreOperation)[number];\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst otherStatuses = [\"none\", \"working\"] as const;\ntype Status = RestoreOperationStatus | (typeof otherStatuses)[number];\ninterface WorkflowState {\n  status: Status;\n  total?: number;\n  failed?: boolean;\n  message?: string;\n}\n\ninterface ExtendedFailureGroupView extends FailureGroupView {\n  index: number;\n  need_user_acknowledgement?: boolean;\n  workflow_state: WorkflowState;\n  operation_remaining_count?: number;\n  hover2?: boolean;\n  hover3?: boolean;\n  operation_start_time?: string;\n  last_operation_completion_time?: string;\n}\n\nlet pollingFaster = false;\nconst archiveGroups = ref<ExtendedFailureGroupView[]>([]);\nconst undismissedRestoreGroups = ref<ExtendedFailureGroupView[]>([]);\nconst loadingData = ref(true);\nconst initialLoadComplete = ref(false);\nconst emit = defineEmits<{\n  InitialLoadComplete: [];\n}>();\nlet refreshInterval: number | undefined = undefined;\nconst route = useRoute();\nconst router = useRouter();\nconst showRestoreGroupModal = ref(false);\nconst selectedGroup = ref<ExtendedFailureGroupView>();\n\nconst serviceControlStore = useServiceControlStore();\nconst messageGroupClient = createMessageGroupClient();\n\nconst groupRestoreSuccessful = ref<boolean | null>(null);\nconst selectedClassifier = ref<string | null>(null);\nconst classifiers = ref<string[]>([]);\n\nasync function getGroupingClassifiers() {\n  const [, data] = await serviceControlStore.fetchTypedFromServiceControl<string[]>(\"recoverability/classifiers\");\n  classifiers.value = data;\n}\n\nfunction saveDefaultGroupingClassifier(classifier: string) {\n  const cookies = useCookies().cookies;\n  cookies.set(\"archived_groups_classification\", classifier);\n}\n\nasync function classifierChanged(classifier: string) {\n  saveDefaultGroupingClassifier(classifier);\n\n  selectedClassifier.value = classifier;\n  archiveGroups.value = [];\n  await loadArchivedMessageGroups(classifier);\n}\n\nasync function getArchiveGroups(classifier: string) {\n  //get all deleted message groups\n  const [, result] = await serviceControlStore.fetchTypedFromServiceControl<FailureGroupView[]>(`errors/groups/${classifier}`);\n\n  if (result.length === 0 && undismissedRestoreGroups.value.length > 0) {\n    undismissedRestoreGroups.value.forEach((deletedGroup) => {\n      deletedGroup.need_user_acknowledgement = true;\n      deletedGroup.workflow_state.status = \"restorecompleted\";\n    });\n  }\n\n  undismissedRestoreGroups.value.forEach((deletedGroup) => {\n    if (!result.find((group) => group.id === deletedGroup.id)) {\n      deletedGroup.need_user_acknowledgement = true;\n      deletedGroup.workflow_state.status = \"restorecompleted\";\n    }\n  });\n\n  // need a map in some ui state for controlling animations\n  const mappedResults = result\n    .filter((group) => !undismissedRestoreGroups.value.find((deletedGroup) => deletedGroup.id === group.id))\n    .map(initializeGroupState)\n    .concat(undismissedRestoreGroups.value);\n\n  let maxIndex = archiveGroups.value.reduce((currentMax, currentGroup) => Math.max(currentMax, currentGroup.index), 0);\n\n  mappedResults.forEach((serverGroup) => {\n    const previousGroup = archiveGroups.value.find((oldGroup) => oldGroup.id === serverGroup.id);\n\n    if (previousGroup) {\n      serverGroup.index = previousGroup.index;\n    } else {\n      serverGroup.index = ++maxIndex;\n    }\n  });\n\n  archiveGroups.value = mappedResults.sort((group1, group2) => {\n    return group1.index - group2.index;\n  });\n}\n\nfunction initializeGroupState(group: FailureGroupView): ExtendedFailureGroupView {\n  return {\n    index: 0,\n    workflow_state: createWorkflowState(\"none\"),\n    ...group,\n  };\n}\n\nfunction loadDefaultGroupingClassifier() {\n  const cookies = useCookies().cookies;\n  const cookieGrouping = cookies.get(\"archived_groups_classification\");\n\n  if (cookieGrouping) {\n    return cookieGrouping;\n  }\n\n  return null;\n}\n\nasync function loadArchivedMessageGroups(groupBy: string | null = null) {\n  loadingData.value = true;\n  if (!initialLoadComplete.value || !groupBy) {\n    groupBy = loadDefaultGroupingClassifier();\n  }\n\n  await getArchiveGroups(groupBy ?? (route.query.deletedGroupBy as string));\n  loadingData.value = false;\n  initialLoadComplete.value = true;\n\n  emit(\"InitialLoadComplete\");\n}\n\n//create workflow state\nfunction createWorkflowState(optionalStatus?: Status, optionalTotal?: number, optionalFailed?: boolean): WorkflowState {\n  if (optionalTotal && optionalTotal <= 1) {\n    optionalTotal = optionalTotal * 100;\n  }\n\n  return {\n    status: optionalStatus ?? \"working\",\n    total: optionalTotal ?? 0,\n    failed: optionalFailed ?? false,\n  };\n}\n\n//Restore operation\nfunction showRestoreGroupDialog(group: ExtendedFailureGroupView) {\n  groupRestoreSuccessful.value = null;\n  selectedGroup.value = group;\n  showRestoreGroupModal.value = true;\n}\n\nasync function restoreGroup() {\n  const group = selectedGroup.value;\n  if (group) {\n    // We're starting a restore, poll more frequently\n    changeRefreshInterval(1000);\n    undismissedRestoreGroups.value.push(group);\n\n    group.workflow_state = { status: \"restorestarted\", message: \"Restore request initiated...\" };\n    group.operation_start_time = new Date().toUTCString();\n\n    const result = await messageGroupClient.restoreGroup(group.id);\n    if (messageGroupClient.isError(result)) {\n      groupRestoreSuccessful.value = false;\n      useShowToast(TYPE.ERROR, \"Error\", `Failed to restore the group: ${result.message}`);\n    } else {\n      groupRestoreSuccessful.value = true;\n      useShowToast(TYPE.INFO, \"Info\", \"Group restore started...\");\n    }\n  }\n}\n\n//getClasses\nconst getClasses = function (stepStatus: Status, currentStatus: Status, statusArray: readonly Status[]) {\n  const indexOfStep = statusArray.indexOf(stepStatus);\n  const indexOfCurrent = statusArray.indexOf(currentStatus);\n  if (indexOfStep > indexOfCurrent) {\n    return \"left-to-do\";\n  } else if (indexOfStep === indexOfCurrent) {\n    return \"active\";\n  }\n\n  return \"completed\";\n};\n\nfunction getClassesForRestoreOperation(stepStatus: Status, currentStatus: Status) {\n  return getClasses(stepStatus, currentStatus, statusesForRestoreOperation);\n}\n\nconst acknowledgeGroup = function (dismissedGroup: FailureGroupView) {\n  undismissedRestoreGroups.value.splice(\n    undismissedRestoreGroups.value.findIndex((group) => {\n      return group.id === dismissedGroup.id;\n    }),\n    1\n  );\n\n  archiveGroups.value.splice(\n    archiveGroups.value.findIndex((group) => group.id === dismissedGroup.id),\n    1\n  );\n};\n\nfunction isBeingRestored(status: Status) {\n  return (statusesForRestoreOperation as readonly Status[]).includes(status);\n}\n\nfunction navigateToGroup(groupId: string) {\n  router.push(routeLinks.failedMessage.deletedGroup.link(groupId));\n}\n\nfunction isRestoreInProgress() {\n  return archiveGroups.value.some((group) => group.workflow_state.status !== \"none\" && group.workflow_state.status !== \"restorecompleted\");\n}\n\nfunction changeRefreshInterval(milliseconds: number) {\n  if (refreshInterval) {\n    clearInterval(refreshInterval);\n  }\n\n  refreshInterval = window.setInterval(() => {\n    // If we're currently polling at 5 seconds and there is a restore in progress, then change the polling interval to poll every 1 second\n    if (!pollingFaster && isRestoreInProgress()) {\n      changeRefreshInterval(1000);\n      pollingFaster = true;\n    } else if (pollingFaster && !isRestoreInProgress()) {\n      // if we're currently polling every 1 second and all restores are done, change polling frequency back to every 5 seconds\n      changeRefreshInterval(5000);\n      pollingFaster = false;\n    }\n\n    loadArchivedMessageGroups();\n  }, milliseconds);\n}\n\nonUnmounted(() => {\n  if (refreshInterval) {\n    clearInterval(refreshInterval);\n  }\n});\n\nonMounted(async () => {\n  await getGroupingClassifiers();\n  let savedClassifier = loadDefaultGroupingClassifier();\n  if (!savedClassifier) {\n    savedClassifier = classifiers.value[0];\n  }\n\n  selectedClassifier.value = savedClassifier;\n  await loadArchivedMessageGroups();\n\n  changeRefreshInterval(5000);\n});\n</script>\n\n<template>\n  <ServiceControlAvailable>\n    <LicenseNotExpired>\n      <section name=\"message_groups\">\n        <div class=\"row\">\n          <div class=\"col-6 list-section\">\n            <h3>Deleted message group</h3>\n          </div>\n\n          <div class=\"col-6 toolbar-menus no-side-padding\">\n            <div class=\"msg-group-menu dropdown\">\n              <label class=\"control-label\">Group by:</label>\n              <button type=\"button\" class=\"btn btn-default dropdown-toggle sp-btn-menu\" data-bs-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                {{ selectedClassifier }}\n                <span class=\"caret\"></span>\n              </button>\n              <ul class=\"dropdown-menu\">\n                <li v-for=\"(classifier, index) in classifiers\" :key=\"index\">\n                  <a @click.prevent=\"classifierChanged(classifier)\">{{ classifier }}</a>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"box-container\">\n          <div class=\"messagegrouplist\">\n            <div>\n              <div class=\"row\">\n                <div class=\"col-sm-12\">\n                  <no-data v-if=\"archiveGroups.length === 0 && !loadingData\" title=\"message groups\" message=\"There are currently no grouped message failures\"></no-data>\n                </div>\n              </div>\n\n              <div class=\"row\">\n                <div class=\"col-sm-12 no-mobile-side-padding\">\n                  <div v-if=\"archiveGroups.length > 0\">\n                    <div\n                      :class=\"`row box box-group wf-${group.workflow_state.status} repeat-modify deleted-message-group`\"\n                      v-for=\"(group, index) in archiveGroups\"\n                      :key=\"index\"\n                      :disabled=\"group.count == 0\"\n                      @mouseenter=\"group.hover2 = true\"\n                      @mouseleave=\"group.hover2 = false\"\n                      @click.prevent=\"navigateToGroup(group.id)\"\n                    >\n                      <div class=\"col-sm-12 no-mobile-side-padding\">\n                        <div class=\"row\">\n                          <div class=\"col-sm-12 no-side-padding\">\n                            <div class=\"row box-header\">\n                              <div class=\"col-sm-12 no-side-padding\">\n                                <p class=\"lead break\" v-bind:class=\"{ 'msg-type-hover': group.hover2, 'msg-type-hover-off': group.hover3 }\">{{ group.title }}</p>\n                                <p class=\"metadata\" v-if=\"!isBeingRestored(group.workflow_state.status)\">\n                                  <MetadataItem :icon=\"faEnvelope\">\n                                    {{ group.count }} message<span v-if=\"group.count > 1\">s</span>\n                                    <span v-if=\"group.operation_remaining_count\"> (currently restoring {{ group.operation_remaining_count }} </span>\n                                  </MetadataItem>\n\n                                  <MetadataItem :icon=\"faClock\">\n                                    First failed:\n                                    <time-since :date-utc=\"group.first\"></time-since>\n                                  </MetadataItem>\n\n                                  <MetadataItem :icon=\"faClock\">\n                                    Last failed:\n                                    <time-since :date-utc=\"group.last\"></time-since>\n                                  </MetadataItem>\n\n                                  <MetadataItem :icon=\"faArrowRotateRight\"> Last retried: <time-since :date-utc=\"group.last_operation_completion_time\"></time-since> </MetadataItem>\n                                </p>\n                              </div>\n                            </div>\n\n                            <div class=\"row\" v-if=\"!isBeingRestored(group.workflow_state.status)\">\n                              <div class=\"col-sm-12 no-side-padding\">\n                                <ActionButton\n                                  variant=\"link\"\n                                  size=\"sm\"\n                                  :icon=\"faArrowRotateRight\"\n                                  :disabled=\"group.count === 0 || isBeingRestored(group.workflow_state.status)\"\n                                  @mouseenter=\"group.hover3 = true\"\n                                  @mouseleave=\"group.hover3 = false\"\n                                  v-if=\"archiveGroups.length > 0\"\n                                  @click.stop=\"showRestoreGroupDialog(group)\"\n                                >\n                                  Restore group\n                                </ActionButton>\n                              </div>\n                            </div>\n\n                            <!--isBeingRestored-->\n                            <div class=\"row\" v-if=\"isBeingRestored(group.workflow_state.status)\">\n                              <div class=\"col-sm-12 no-side-padding\">\n                                <div class=\"panel panel-default panel-retry\">\n                                  <div class=\"panel-body\">\n                                    <ul class=\"retry-request-progress\">\n                                      <li v-if=\"group.workflow_state.status !== 'restorecompleted'\" :class=\"getClassesForRestoreOperation('restorestarted', group.workflow_state.status)\">\n                                        <div class=\"bulk-retry-progress-status\">Restore request in progress...</div>\n                                      </li>\n                                      <li v-if=\"group.workflow_state.status === 'restorecompleted'\">\n                                        <div class=\"retry-completed bulk-retry-progress-status\">Restore request completed</div>\n                                        <button type=\"button\" class=\"btn btn-default btn-primary btn-xs btn-retry-dismiss\" v-if=\"group.need_user_acknowledgement == true\" @click.stop=\"acknowledgeGroup(group)\">Dismiss</button>\n                                      </li>\n                                    </ul>\n                                    <div class=\"op-metadata\">\n                                      <MetadataItem :icon=\"faClock\"> Restore request started: <time-since :date-utc=\"group.operation_start_time\"></time-since> </MetadataItem>\n                                      <MetadataItem v-if=\"group.workflow_state.status === 'restorecompleted'\" :icon=\"faEnvelope\"> Messages restored: {{ group.count }} </MetadataItem>\n                                      <MetadataItem v-if=\"group.workflow_state.status !== 'restorecompleted'\" :icon=\"faEnvelope\"> Messages being restored: {{ group.count }} </MetadataItem>\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <!--modal display - restore group-->\n          <Teleport to=\"#modalDisplay\">\n            <ConfirmDialog\n              v-if=\"showRestoreGroupModal\"\n              @cancel=\"showRestoreGroupModal = false\"\n              @confirm=\"\n                showRestoreGroupModal = false;\n                restoreGroup();\n              \"\n              :heading=\"'Are you sure you want to restore this group?'\"\n              :body=\"`Restored messages will be moved back to the list of failed messages`\"\n            ></ConfirmDialog>\n          </Teleport>\n        </div>\n      </section>\n    </LicenseNotExpired>\n  </ServiceControlAvailable>\n</template>\n\n<style scoped>\n@import \"../list.css\";\n@import \"./failedmessages.css\";\n\n.fake-link i {\n  padding-right: 0.2em;\n}\n\n.msg-group-menu.dropdown {\n  float: right;\n}\n\n.dropdown > button:hover {\n  background: none;\n  border: none;\n  color: var(--sp-blue);\n  text-decoration: underline;\n}\n</style>\n"],"names":["statusesForRestoreOperation","pollingFaster","archiveGroups","ref","undismissedRestoreGroups","loadingData","initialLoadComplete","emit","__emit","refreshInterval","route","useRoute","router","useRouter","showRestoreGroupModal","selectedGroup","serviceControlStore","useServiceControlStore","messageGroupClient","createMessageGroupClient","groupRestoreSuccessful","selectedClassifier","classifiers","getGroupingClassifiers","data","saveDefaultGroupingClassifier","classifier","useCookies","classifierChanged","loadArchivedMessageGroups","getArchiveGroups","result","deletedGroup","group","mappedResults","initializeGroupState","maxIndex","currentMax","currentGroup","serverGroup","previousGroup","oldGroup","group1","group2","createWorkflowState","loadDefaultGroupingClassifier","cookieGrouping","groupBy","optionalStatus","optionalTotal","optionalFailed","showRestoreGroupDialog","restoreGroup","changeRefreshInterval","useShowToast","TYPE","getClasses","stepStatus","currentStatus","statusArray","indexOfStep","indexOfCurrent","getClassesForRestoreOperation","acknowledgeGroup","dismissedGroup","isBeingRestored","status","navigateToGroup","groupId","routeLinks","isRestoreInProgress","milliseconds","onUnmounted","onMounted","savedClassifier","_createBlock","ServiceControlAvailable","_createVNode","LicenseNotExpired","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_cache","_hoisted_5","_createTextVNode","_toDisplayString","_hoisted_6","_openBlock","_createElementBlock","_Fragment","_renderList","index","_withModifiers","$event","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","NoData","_hoisted_12","_hoisted_13","_hoisted_14","_normalizeClass","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","MetadataItem","_unref","faEnvelope","_hoisted_23","faClock","TimeSince","faArrowRotateRight","_hoisted_24","_hoisted_25","ActionButton","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_Teleport","ConfirmDialog"],"mappings":"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"}