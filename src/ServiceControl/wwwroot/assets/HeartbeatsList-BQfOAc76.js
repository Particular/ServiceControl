import{e as H,V as N,s as R,f as U,l as B,m as r,n as t,q as i,v as d,p as k,t as u,z as e,W as s,D as g,I as f,x as m,K as y,L as D,a2 as _,k as E,y as p,B as b,_ as T,E as M,a0 as $,a1 as O,a3 as q,G as V,P as w,Q as I,U as z}from"./index-tFZp7u44.js";import{a as A,_ as F}from"./LastHeartbeat.vue_vue_type_script_setup_true_lang-UPMrHroj.js";import{O as W}from"./OnOffSwitch-CICGC8TS.js";const G={role:"table","aria-label":"endpoint-instances"},K={role:"row","aria-label":"column-headers",class:"row table-head-row",style:{borderTop:0}},Q={role:"rowgroup","aria-label":"endpoints"},Y=["aria-label"],j={key:0,role:"cell","aria-label":"instance-name",class:"col-6 host-name"},J={class:"box-header"},X={style:{overflowWrap:"break-word"}},Z={key:1,role:"cell",class:"col-2"},ee={class:"endpoint-count","aria-label":"instance-count"},ae={key:2,role:"cell","aria-label":"last-heartbeat",class:"col-2 last-heartbeat"},le={key:3,role:"cell","aria-label":"tracked-instances",class:"col-1 centre"},te={key:4,role:"cell","aria-label":"tracked-instances",class:"col-2 centre"},se={class:"switch"},ne={key:5,role:"cell","aria-label":"muted",class:"col-1 centre"},oe={class:"instances-muted","aria-label":"Muted instance count"},ce={class:"instances-muted"},ue=H({__name:"HeartbeatsList",props:{data:{},columns:{}},setup(o){const{store:h}=N(),{sortByInstances:l,itemsPerPage:x}=R(h),S=U();async function C(v){try{await h.updateEndpointSettings([v]),w(I.SUCCESS,"Saved","",!1,{timeout:3e3})}catch{w(I.ERROR,"Save failed","",!1,{timeout:3e3})}}function L(v){return v.alive_count===0?"text-danger":v.track_instances&&v.down_count>0?"text-warning":"text-success"}return(v,n)=>{const P=B("RouterLink");return t(),r("section",G,[i("div",K,[o.columns.includes(e(s).Name)?(t(),k(f,{key:0,name:e(s).Name,label:"Name",class:"col-6",sortable:"",modelValue:e(l),"onUpdate:modelValue":n[0]||(n[0]=c=>g(l)?l.value=c:null),"default-ascending":""},null,8,["name","modelValue"])):u("",!0),o.columns.includes(e(s).InstancesDown)?(t(),k(f,{key:1,name:e(s).InstancesDown,label:"Instances Down",class:"col-2",sortable:"",modelValue:e(l),"onUpdate:modelValue":n[1]||(n[1]=c=>g(l)?l.value=c:null),"default-ascending":""},null,8,["name","modelValue"])):u("",!0),o.columns.includes(e(s).InstancesTotal)?(t(),k(f,{key:2,name:e(s).InstancesTotal,label:"Instances",class:"col-2",sortable:"",modelValue:e(l),"onUpdate:modelValue":n[2]||(n[2]=c=>g(l)?l.value=c:null),"default-ascending":""},null,8,["name","modelValue"])):u("",!0),o.columns.includes(e(s).LastHeartbeat)?(t(),k(f,{key:3,name:e(s).LastHeartbeat,label:"Last Heartbeat",class:"col-2",sortable:"",modelValue:e(l),"onUpdate:modelValue":n[3]||(n[3]=c=>g(l)?l.value=c:null)},null,8,["name","modelValue"])):u("",!0),o.columns.includes(e(s).Tracked)?(t(),k(f,{key:4,name:e(s).Tracked,label:"Track Instances",class:"col-1 centre",sortable:"",modelValue:e(l),"onUpdate:modelValue":n[4]||(n[4]=c=>g(l)?l.value=c:null)},null,8,["name","modelValue"])):u("",!0),o.columns.includes(e(s).TrackToggle)?(t(),k(f,{key:5,name:e(s).TrackToggle,label:"Track Instances",class:"col-2 centre",sortable:"",modelValue:e(l),"onUpdate:modelValue":n[5]||(n[5]=c=>g(l)?l.value=c:null)},null,8,["name","modelValue"])):u("",!0),o.columns.includes(e(s).Muted)?(t(),k(f,{key:6,name:e(s).Muted,label:"Instances Muted",class:"col-1 centre",sortable:"",modelValue:e(l),"onUpdate:modelValue":n[6]||(n[6]=c=>g(l)?l.value=c:null)},null,8,["name","modelValue"])):u("",!0)]),d(A,{data:o.data,"show-items-per-page":!0,"items-per-page":e(x),onItemsPerPageChanged:e(h).setItemsPerPage},{data:m(({pageData:c})=>[i("div",Q,[(t(!0),r(y,null,D(c,a=>(t(),r("div",{role:"row","aria-label":a.name,class:"row grid-row",key:a.name},[o.columns.includes(e(s).Name)?(t(),r("div",j,[i("div",J,[d(e(_),{"aria-label":a.name,delay:[700,0],class:"no-side-padding lead righ-side-ellipsis endpoint-details-link"},{content:m(()=>[i("p",X,b(a.name),1)]),default:m(()=>[d(P,{class:"hackToPreventSafariFromShowingTooltip","aria-label":"details-link",to:{path:e(E).heartbeats.instances.link(a.name),query:{back:e(S).path}}},{default:m(()=>[p(b(a.name),1)]),_:2},1032,["to"])]),_:2},1032,["aria-label"])])])):u("",!0),o.columns.includes(e(s).InstancesTotal)||o.columns.includes(e(s).InstancesDown)?(t(),r("div",Z,[d(e(_),{delay:[300,0]},{content:m(()=>[a.track_instances?(t(),r(y,{key:0},[n[7]||(n[7]=i("p",null,"Tracking all instances",-1)),i("p",null,b(a.alive_count)+" alive",1),i("p",null,b(a.down_count)+" no heartbeat",1)],64)):(t(),r(y,{key:1},[n[8]||(n[8]=i("p",null,"Not tracking instances",-1)),i("p",null,b(a.alive_count)+" alive",1)],64))]),default:m(()=>[d(T,{icon:a.track_instances?e($):e(O),class:M(["icon",L(a)])},null,8,["icon","class"]),i("span",ee,b(e(h).instanceDisplayText(a)),1)]),_:2},1024)])):u("",!0),o.columns.includes(e(s).LastHeartbeat)?(t(),r("div",ae,[d(F,{date:a.heartbeat_information?.last_report_at,"tooltip-target":"endpoint"},null,8,["date"])])):u("",!0),o.columns.includes(e(s).Tracked)?(t(),r("div",le,[a.track_instances?(t(),k(e(_),{key:0,id:"tracked-instance-desc",content:"Instances are being tracked",delay:[1e3,0]},{default:m(()=>[d(T,{icon:e(q),class:"text-success","aria-title":"Instances are being tracked"},null,8,["icon"])]),_:1})):u("",!0)])):u("",!0),o.columns.includes(e(s).TrackToggle)?(t(),r("div",te,[i("div",se,[d(W,{id:a.name,onToggle:re=>C(a),value:a.track_instances},null,8,["id","onToggle","value"])])])):u("",!0),o.columns.includes(e(s).Muted)?(t(),r("div",ne,[a.muted_count===a.alive_count+a.down_count?(t(),r(y,{key:0},[d(e(_),{content:"All instances have alerts muted",delay:[300,0]},{default:m(()=>[d(T,{icon:e(V),class:"text-danger"},null,8,["icon"])]),_:1}),i("span",oe,b(a.muted_count),1)],64)):a.muted_count>0?(t(),r(y,{key:1},[d(e(_),{content:`${a.muted_count} instance(s) have alerts muted`,delay:[300,0]},{default:m(()=>[d(T,{icon:e(V),class:"text-warning"},null,8,["icon"])]),_:1},8,["content"]),i("span",ce,b(a.muted_count),1)],64)):u("",!0)])):u("",!0)],8,Y))),128))])]),_:1},8,["data","items-per-page","onItemsPerPageChanged"])])}}}),ke=z(ue,[["__scopeId","data-v-0699db3c"]]);export{ke as H};
//# sourceMappingURL=HeartbeatsList-BQfOAc76.js.map
