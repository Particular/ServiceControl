{"version":3,"file":"PendingRetries-DOXP1zqO.js","sources":["../../../../frontend/src/components/failedmessages/PendingRetries.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onMounted, onUnmounted, ref, useTemplateRef, watch } from \"vue\";\nimport { useShowToast } from \"../../composables/toast\";\nimport { useCookies } from \"vue3-cookies\";\nimport OrderBy from \"@/components/OrderBy.vue\";\nimport LicenseNotExpired from \"../../components/LicenseNotExpired.vue\";\nimport ServiceControlAvailable from \"../ServiceControlAvailable.vue\";\nimport MessageList, { IMessageList } from \"./MessageList.vue\";\nimport ConfirmDialog from \"../ConfirmDialog.vue\";\nimport PaginationStrip from \"../../components/PaginationStrip.vue\";\nimport { ExtendedFailedMessage, FailedMessageStatus } from \"@/resources/FailedMessage\";\nimport SortOptions, { SortDirection } from \"@/resources/SortOptions\";\nimport QueueAddress from \"@/resources/QueueAddress\";\nimport { TYPE } from \"vue-toastification\";\nimport GroupOperation from \"@/resources/GroupOperation\";\nimport { faArrowDownAZ, faArrowDownZA, faArrowDownShortWide, faArrowDownWideShort, faInfoCircle, faExternalLink, faFilter, faTimes, faArrowRightRotate } from \"@fortawesome/free-solid-svg-icons\";\nimport FAIcon from \"@/components/FAIcon.vue\";\nimport ActionButton from \"@/components/ActionButton.vue\";\nimport { faCheckSquare } from \"@fortawesome/free-regular-svg-icons\";\nimport { useServiceControlStore } from \"@/stores/ServiceControlStore\";\nimport { useConfigurationStore } from \"@/stores/ConfigurationStore\";\nimport { storeToRefs } from \"pinia\";\n\nconst serviceControlStore = useServiceControlStore();\nconst configurationStore = useConfigurationStore();\nconst { isMassTransitConnected } = storeToRefs(configurationStore);\n\nlet refreshInterval: number | undefined;\nlet sortMethod: SortOptions<GroupOperation> | undefined;\nconst perPage = 50;\nconst cookies = useCookies().cookies;\nconst selectedPeriod = ref(\"All Pending Retries\");\nconst endpoints = ref<string[]>([]);\nconst messageList = useTemplateRef<IMessageList>(\"messageList\");\nconst messages = ref<ExtendedFailedMessage[]>([]);\nconst selectedQueue = ref(\"empty\");\nconst showConfirmRetry = ref(false);\nconst showConfirmResolve = ref(false);\nconst showConfirmResolveAll = ref(false);\nconst showCantRetryAll = ref(false);\nconst showRetryAllConfirm = ref(false);\nconst pageNumber = ref(1);\nconst totalCount = ref(0);\nconst isInitialLoad = ref(true);\nconst sortOptions: SortOptions<GroupOperation>[] = [\n  {\n    description: \"Time of failure\",\n    iconAsc: faArrowDownShortWide,\n    iconDesc: faArrowDownWideShort,\n  },\n  {\n    description: \"Message Type\",\n    iconAsc: faArrowDownAZ,\n    iconDesc: faArrowDownZA,\n  },\n  {\n    description: \"Time of retry request\",\n    iconAsc: faArrowDownShortWide,\n    iconDesc: faArrowDownWideShort,\n  },\n];\nconst periodOptions = [\"All Pending Retries\", \"Retried in the last 2 Hours\", \"Retried in the last 1 Day\", \"Retried in the last 7 Days\"];\n\nwatch(pageNumber, () => loadPendingRetryMessages());\n\nasync function loadEndpoints() {\n  const [, data] = await serviceControlStore.fetchTypedFromServiceControl<QueueAddress[]>(\"errors/queues/addresses\");\n  endpoints.value = data.map((endpoint) => endpoint.physical_address);\n}\n\nfunction clearSelectedQueue() {\n  selectedQueue.value = \"empty\";\n  loadPendingRetryMessages();\n}\n\nfunction loadPendingRetryMessages() {\n  let startDate = new Date(0);\n  const endDate = new Date();\n\n  switch (selectedPeriod.value) {\n    case \"Retried in the last 2 Hours\":\n      startDate = new Date();\n      startDate.setHours(startDate.getHours() - 2);\n      break;\n\n    case \"Retried in the last 1 Day\":\n      startDate = new Date();\n      startDate.setHours(startDate.getHours() - 24);\n      break;\n\n    case \"Retried in the last 7 days\":\n      startDate = new Date();\n      startDate.setHours(startDate.getHours() - 24 * 7);\n      break;\n  }\n\n  return loadPagedPendingRetryMessages(pageNumber.value, selectedQueue.value, startDate, endDate, sortMethod?.description.replaceAll(\" \", \"_\").toLowerCase(), sortMethod?.dir);\n}\n\nasync function loadPagedPendingRetryMessages(page: number, searchPhrase: string, startDate: Date, endDate: Date, sortBy?: string, direction?: SortDirection) {\n  sortBy ??= \"time_of_failure\";\n  direction ??= SortDirection.Descending;\n  if (searchPhrase === \"empty\") searchPhrase = \"\";\n\n  try {\n    const [response, data] = await serviceControlStore.fetchTypedFromServiceControl<ExtendedFailedMessage[]>(\n      `errors?status=${FailedMessageStatus.RetryIssued}&page=${page}&per_page=${perPage}&sort=${sortBy}&direction=${direction}&queueaddress=${searchPhrase}&modified=${startDate.toISOString()}...${endDate.toISOString()}`\n    );\n    totalCount.value = parseInt(response.headers.get(\"Total-Count\") ?? \"0\");\n\n    messages.value.forEach((previousMessage: ExtendedFailedMessage) => {\n      const receivedMessage = data.find((m) => m.id === previousMessage.id);\n      if (receivedMessage) {\n        if (previousMessage.last_modified === receivedMessage.last_modified) {\n          receivedMessage.submittedForRetrial = previousMessage.submittedForRetrial;\n          receivedMessage.resolved = previousMessage.resolved;\n        }\n\n        receivedMessage.selected = previousMessage.selected;\n      }\n    });\n\n    messages.value = data;\n  } catch (err) {\n    console.log(err);\n    const result = {\n      message: \"error\",\n    };\n    return result;\n  }\n}\n\nfunction numberDisplayed() {\n  return messageList.value?.numberDisplayed();\n}\n\nfunction isAnythingDisplayed() {\n  return messageList.value?.isAnythingDisplayed();\n}\n\nfunction isAnythingSelected() {\n  return messageList.value?.isAnythingSelected();\n}\n\nfunction numberSelected() {\n  return messageList.value?.getSelectedMessages()?.length ?? 0;\n}\n\nasync function retrySelectedMessages() {\n  const selectedMessages = messageList.value?.getSelectedMessages() ?? [];\n\n  useShowToast(TYPE.INFO, \"Info\", \"Selected messages were submitted for retry...\");\n  await serviceControlStore.postToServiceControl(\n    \"pendingretries/retry\",\n    selectedMessages.map((m) => m.id)\n  );\n\n  messageList.value?.deselectAll();\n  selectedMessages.forEach((m) => (m.submittedForRetrial = true));\n}\n\nasync function resolveSelectedMessages() {\n  const selectedMessages = messageList.value?.getSelectedMessages() ?? [];\n\n  useShowToast(TYPE.INFO, \"Info\", \"Selected messages were marked as resolved.\");\n  await serviceControlStore.patchToServiceControl(\"pendingretries/resolve\", { uniquemessageids: selectedMessages.map((m) => m.id) });\n  messageList.value?.deselectAll();\n  selectedMessages.forEach((m) => (m.resolved = true));\n}\n\nasync function resolveAllMessages() {\n  useShowToast(TYPE.INFO, \"Info\", \"All filtered messages were marked as resolved.\");\n  await serviceControlStore.patchToServiceControl(\"pendingretries/resolve\", { from: new Date(0).toISOString(), to: new Date().toISOString() });\n  messageList.value?.deselectAll();\n  messageList.value?.resolveAll();\n}\n\nasync function retryAllMessages() {\n  let url = \"pendingretries/retry\";\n  const data: { from: string; to: string; queueaddress?: string } = {\n    from: new Date(0).toISOString(),\n    to: new Date(0).toISOString(),\n  };\n  if (selectedQueue.value !== \"empty\") {\n    url = \"pendingretries/queues/retry\";\n    data.queueaddress = selectedQueue.value;\n  }\n\n  await serviceControlStore.postToServiceControl(url, data);\n  messages.value.forEach((message) => {\n    message.selected = false;\n    message.submittedForRetrial = true;\n    message.retried = false;\n  });\n}\n\nfunction retryAllClicked() {\n  if (selectedQueue.value === \"empty\") {\n    showCantRetryAll.value = true;\n  } else {\n    showRetryAllConfirm.value = true;\n  }\n}\n\nfunction sortGroups(sort: SortOptions<GroupOperation>) {\n  sortMethod = sort;\n\n  if (!isInitialLoad.value) {\n    loadPendingRetryMessages();\n  }\n}\n\nfunction periodChanged(period: string) {\n  selectedPeriod.value = period;\n  cookies.set(\"pending_retries_period\", period);\n\n  loadPendingRetryMessages();\n}\n\nonUnmounted(() => {\n  if (refreshInterval != null) {\n    window.clearInterval(refreshInterval);\n  }\n});\n\nonMounted(() => {\n  let cookiePeriod = cookies.get(\"pending_retries_period\");\n  if (!cookiePeriod) {\n    cookiePeriod = periodOptions[0]; //default All Pending Retries\n  }\n\n  selectedPeriod.value = cookiePeriod;\n\n  loadEndpoints();\n\n  loadPendingRetryMessages();\n\n  refreshInterval = window.setInterval(() => {\n    loadPendingRetryMessages();\n  }, 5000);\n\n  isInitialLoad.value = false;\n});\n</script>\n\n<template>\n  <ServiceControlAvailable>\n    <LicenseNotExpired>\n      <section name=\"pending_retries\">\n        <div class=\"row\">\n          <div class=\"col-12\">\n            <div class=\"alert alert-info\">\n              <FAIcon :icon=\"faInfoCircle\" class=\"icon info\" /> To check if a retried message was also processed successfully, enable\n              <a href=\"https://docs.particular.net/nservicebus/operations/auditing\" target=\"_blank\">message auditing <FAIcon :icon=\"faExternalLink\" /></a>\n            </div>\n          </div>\n          <div class=\"col-12\" v-if=\"isMassTransitConnected\">\n            <div class=\"alert alert-info\">MassTransit endpoints currently do not report when a pending retry has succeeded, and therefore any messages associated with those endpoints will need to be manually marked as resolved.</div>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-6\">\n            <div class=\"filter-input\">\n              <div class=\"input-group mb-3\">\n                <label class=\"input-group-text\"><FAIcon :icon=\"faFilter\" size=\"sm\" class=\"icon\" /> <span class=\"hidden-xs\">Filter</span></label>\n                <select class=\"form-select\" id=\"inputGroupSelect01\" onchange=\"this.dataset.chosen = true;\" @change=\"loadPendingRetryMessages()\" v-model=\"selectedQueue\">\n                  <option selected disabled hidden class=\"placeholder\" value=\"empty\">Select a queue...</option>\n                  <option v-for=\"(endpoint, index) in endpoints\" :key=\"index\" :value=\"endpoint\">\n                    {{ endpoint }}\n                  </option>\n                </select>\n                <span class=\"input-group-btn\">\n                  <ActionButton @click=\"clearSelectedQueue()\" :icon=\"faTimes\" />\n                </span>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-6\">\n            <div class=\"msg-group-menu dropdown\">\n              <label class=\"control-label\">Period:</label>\n              <button type=\"button\" class=\"btn btn-default dropdown-toggle sp-btn-menu\" data-bs-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                {{ selectedPeriod }}\n                <span class=\"caret\"></span>\n              </button>\n              <ul class=\"dropdown-menu\">\n                <li v-for=\"(period, index) in periodOptions\" :key=\"index\">\n                  <a @click.prevent=\"periodChanged(period)\">{{ period }}</a>\n                </li>\n              </ul>\n            </div>\n            <OrderBy @sort-updated=\"sortGroups\" :hideGroupBy=\"true\" :sortOptions=\"sortOptions\" sortSavePrefix=\"pending_retries\"></OrderBy>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-6 col-xs-12 toolbar-menus\">\n            <div class=\"action-btns\">\n              <ActionButton :icon=\"faArrowRightRotate\" :disabled=\"!isAnythingSelected()\" @click=\"showConfirmRetry = true\"><span>Retry</span> ({{ numberSelected() }})</ActionButton>\n              <ActionButton :icon=\"faCheckSquare\" :disabled=\"!isAnythingSelected()\" @click=\"showConfirmResolve = true\"><span>Mark as resolved</span> ({{ numberSelected() }})</ActionButton>\n              <ActionButton :icon=\"faArrowRightRotate\" :disabled=\"!isAnythingDisplayed()\" @click=\"retryAllClicked()\"><span>Retry all</span></ActionButton>\n              <ActionButton :icon=\"faCheckSquare\" @click=\"showConfirmResolveAll = true\"><span>Mark all as resolved</span></ActionButton>\n            </div>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-12\">\n            <MessageList :messages=\"messages\" ref=\"messageList\"></MessageList>\n          </div>\n        </div>\n        <div class=\"row\">\n          <PaginationStrip v-model=\"pageNumber\" :total-count=\"totalCount\" :items-per-page=\"perPage\" />\n        </div>\n        <Teleport to=\"#modalDisplay\">\n          <ConfirmDialog\n            v-if=\"showConfirmRetry === true\"\n            @cancel=\"showConfirmRetry = false\"\n            @confirm=\"\n              showConfirmRetry = false;\n              retrySelectedMessages();\n            \"\n            :heading=\"'Are you sure you want to retry the selected messages?'\"\n            :body=\"'Ensure that the selected messages were not processed previously as this will create a duplicate message.'\"\n            :second-paragraph=\"'NOTE: If the selection includes messages to be processed via unaudited endpoints, those messages will need to be marked as resolved once the retry is manually verified'\"\n          ></ConfirmDialog>\n\n          <ConfirmDialog\n            v-if=\"showConfirmResolve === true\"\n            @cancel=\"showConfirmResolve = false\"\n            @confirm=\"\n              showConfirmResolve = false;\n              resolveSelectedMessages();\n            \"\n            :heading=\"'Are you sure you want to mark as resolved the selected messages?'\"\n            :body=\"`If you mark these messages as resolved they will not be available for Retry. Messages should only be marked as resolved only if they belong to unaudited endpoints.`\"\n          ></ConfirmDialog>\n\n          <ConfirmDialog\n            v-if=\"showConfirmResolveAll === true\"\n            @cancel=\"showConfirmResolveAll = false\"\n            @confirm=\"\n              showConfirmResolveAll = false;\n              resolveAllMessages();\n            \"\n            :heading=\"'Are you sure you want to resolve all messages?'\"\n            :body=\"`Are you sure you want to mark all ${numberDisplayed()} messages as resolved? If you do they will not be available for Retry.`\"\n          ></ConfirmDialog>\n\n          <ConfirmDialog\n            v-if=\"showCantRetryAll === true\"\n            @cancel=\"showCantRetryAll = false\"\n            @confirm=\"showCantRetryAll = false\"\n            :hide-cancel=\"true\"\n            :heading=\"'Select a queue first'\"\n            :body=\"'Bulk retry of messages can only be done for one queue at the time to avoid producing unwanted message duplicates.'\"\n          ></ConfirmDialog>\n\n          <ConfirmDialog\n            v-if=\"showRetryAllConfirm === true\"\n            @cancel=\"showRetryAllConfirm = false\"\n            @confirm=\"\n              showRetryAllConfirm = false;\n              retryAllMessages();\n            \"\n            :heading=\"'Confirm retry of all messages?'\"\n            :body=\"'Are you sure you want to retry all previously retried messages? If the selected messages were processed in the meanwhile, then duplicate messages will be produced.'\"\n          ></ConfirmDialog>\n        </Teleport>\n      </section>\n    </LicenseNotExpired>\n  </ServiceControlAvailable>\n</template>\n\n<style scoped>\n@import \"../list.css\";\n\n.input-group-text {\n  margin-bottom: 0;\n}\n\n.input-group-text > span {\n  font-size: 14px;\n  color: #555;\n}\n\n.input-group > select {\n  font-size: 14px;\n  color: #777777;\n}\n\n.input-group > select[data-chosen=\"true\"] {\n  color: #212529;\n}\n\n.input-group > select:hover {\n  box-shadow: 0 0 10px 100px var(--bs-btn-hover-bg) inset;\n  color: #212529;\n}\n\n.input-group-btn:last-child > .btn {\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n\n.action-btns > .btn {\n  margin-right: 5px;\n}\n\n.dropdown-toggle.btn-default:hover {\n  background: none;\n  border: none;\n  color: var(--sp-blue);\n}\n\n.icon {\n  color: var(--reduced-emphasis);\n  padding-right: 6px;\n}\n\n.icon.info {\n  color: #31708f;\n}\n</style>\n"],"names":["perPage","serviceControlStore","useServiceControlStore","configurationStore","useConfigurationStore","isMassTransitConnected","storeToRefs","refreshInterval","sortMethod","cookies","useCookies","selectedPeriod","ref","endpoints","messageList","useTemplateRef","messages","selectedQueue","showConfirmRetry","showConfirmResolve","showConfirmResolveAll","showCantRetryAll","showRetryAllConfirm","pageNumber","totalCount","isInitialLoad","sortOptions","faArrowDownShortWide","faArrowDownWideShort","faArrowDownAZ","faArrowDownZA","periodOptions","watch","loadPendingRetryMessages","loadEndpoints","data","endpoint","clearSelectedQueue","startDate","endDate","loadPagedPendingRetryMessages","page","searchPhrase","sortBy","direction","SortDirection","response","FailedMessageStatus","previousMessage","receivedMessage","m","err","numberDisplayed","isAnythingDisplayed","isAnythingSelected","numberSelected","retrySelectedMessages","selectedMessages","useShowToast","TYPE","resolveSelectedMessages","resolveAllMessages","retryAllMessages","url","message","retryAllClicked","sortGroups","sort","periodChanged","period","onUnmounted","onMounted","cookiePeriod","_createBlock","ServiceControlAvailable","_createVNode","LicenseNotExpired","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","FAIcon","_unref","faInfoCircle","_hoisted_5","faExternalLink","_openBlock","_createElementBlock","_hoisted_6","_cache","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","faFilter","$event","_Fragment","_renderList","index","_hoisted_12","_hoisted_13","ActionButton","faTimes","_hoisted_14","_hoisted_15","_hoisted_16","_createTextVNode","_toDisplayString","_hoisted_17","_withModifiers","_hoisted_18","OrderBy","_hoisted_19","_hoisted_20","_hoisted_21","faArrowRightRotate","faCheckSquare","_hoisted_22","_hoisted_23","MessageList","_hoisted_24","PaginationStrip","_Teleport","ConfirmDialog"],"mappings":"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"}