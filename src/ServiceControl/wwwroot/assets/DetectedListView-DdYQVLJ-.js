import{bU as $,r as p,e as te,aW as ne,bV as ae,c as O,bW as oe,o as se,w as le,aM as ie,m as l,n as o,K as g,q as n,p as N,L as x,B as d,v,z as c,R as re,ai as ce,t as T,C as ue,T as de,y as E,a7 as D,_ as S,aE as L,Z as pe,P as he,Q as me,U as ye}from"./index-Cy3_77ur.js";import{U as P,u as b}from"./userIndicatorMapper-CH8_AcCf.js";import{D as _e}from"./DropDown-DIzPgALY.js";var A=(i=>(i.WellKnownEndpoint="ServiceControl",i.Broker="Broker",i))(A||{});const C=p([]),V=p(!1),fe=i=>{C.value.push(i.key)};$(i=>{if(C.value.length>0){const h=setTimeout(()=>C.value.splice(0),5e3);i(()=>clearTimeout(h))}});window.document.addEventListener("keydown",fe);function ge(i){return $(()=>{C.value.toString()===i.toString()&&(V.value=!0)}),V}const ve={class:"row filters"},we={class:"col"},xe={class:"text-search-container"},be=["value"],Ce=["value"],ke={class:"col",style:{"align-content":"center"}},Te={class:"col text-end"},Ee={class:"table"},De={class:"col",colspan:"2"},Se={class:"col",style:{width:"350px","padding-left":"0"}},Le={class:"dropdown"},Ue=["disabled"],Be={class:"dropdown-menu"},Ie=["aria-label","onClick"],Fe=["aria-label"],We={scope:"col"},Me={key:0,scope:"col",class:"text-end formatThroughputColumn"},Oe={key:1,scope:"col",class:"text-end formatThroughputColumn"},Ne={scope:"col"},Pe={key:0},Ve={colspan:"3",class:"text-center"},$e={class:"col","aria-label":"name"},Ae={key:0,class:"col text-end formatThroughputColumn",style:{width:"250px"},"aria-label":"maximum usage throughput"},He={key:1,class:"col text-end formatThroughputColumn",style:{width:"250px"},"aria-label":"maximum usage throughput"},Ke={class:"col",style:{width:"350px"},"aria-label":"endpoint type"},Re=["onChange"],qe={key:0,value:""},ze=["value","selected"],Qe=te({__name:"DetectedListView",props:{ariaLabel:{},columnTitle:{},showEndpointTypePlaceholder:{type:Boolean},indicatorOptions:{},source:{}},setup(i){const h=[{text:"name",comparer:(e,t)=>e.name.localeCompare(t.name)},{text:"throughput",comparer:(e,t)=>e.max_daily_throughput-t.max_daily_throughput},{text:"endpoint type",comparer:(e,t)=>e.user_indicator.localeCompare(t.user_indicator)}].flatMap(e=>[{text:e.text,value:e.text,comparer:e.comparer},{text:`${e.text} (Descending)`,value:`${e.text} (Descending)`,comparer:(t,s)=>-e.comparer(t,s)}]),m=i,y=p([]),_=p(new Map),r=ne({name:"",nameFilterType:"Begins with",sort:"name",showUnsetOnly:!1}),H=ae(),{license:K}=H,U=[{text:"Begins with",filter:e=>e.name.toLowerCase().startsWith(r.name.toLowerCase())},{text:"Contains",filter:e=>e.name.toLowerCase().includes(r.name.toLowerCase())},{text:"Ends with",filter:e=>e.name.toLowerCase().endsWith(r.name.toLowerCase())}],f=O(()=>{const e=h.find(t=>t.value===r.sort);return y.value.filter(t=>!t.name||U.find(s=>s.text===r.nameFilterType)?.filter(t)).filter(t=>r.showUnsetOnly?_.value.get(t.name)?.indicator==="":!0).sort(e?.comparer)}),R=ge(["ArrowUp","ArrowUp","ArrowDown","ArrowDown"]),B=O(()=>K.edition==="MonthlyUsage"||R.value),I=oe();se(async()=>{await F()}),le(y,e=>{_.value=new Map(e.map(t=>[t.name,{indicator:t.user_indicator}]))},{deep:!0});const w=p(!1);function q(){w.value=!1}function z(){w.value=!1,J()}async function F(){const e=await I.endpoints();y.value=e.filter(t=>t.is_known_endpoint===(m.source===A.WellKnownEndpoint))}function Q(e){r.name=e.target.value}function Y(e){r.sort=e.value}function Z(e){r.nameFilterType=e.target.value}function j(e,t){const s=e.target.value;W(t,a=>a.indicator=s),M()}function G(e){k.value=e,w.value=!0}function J(){f.value.forEach(e=>{W(e.name,t=>t.indicator=k.value)}),M()}function W(e,t){const s=_.value.get(e);s&&t(s)}function X(e){r.showUnsetOnly=e.target.checked}const k=p(P.NServiceBusEndpoint);function ee(e){if(e.is_known_endpoint)return P.NServiceBusEndpoint.toString()}async function M(){const e=[];_.value.forEach((t,s)=>{e.push({name:s,user_indicator:t.indicator})}),await I.updateIndicators(e),he(me.SUCCESS,"Saved","",!1,{timeout:1e3}),await F()}return(e,t)=>{const s=ie("tippy");return o(),l(g,null,[n("div",null,[n("div",ve,[n("div",we,[n("div",xe,[n("div",null,[n("select",{class:"form-select text-search format-text","aria-label":"Filter name type",onChange:Z},[(o(),l(g,null,x(U,a=>n("option",{value:a.text,key:a.text},d(a.text),9,be)),64))],32)]),n("div",null,[n("input",{type:"search","aria-label":"Filter by name",class:"form-control format-text",value:r.name,onInput:Q,placeholder:"Filter by name..."},null,40,Ce)])])]),n("div",ke,[n("div",null,[n("input",{type:"checkbox","aria-label":"Show only not set Endpoint Types",class:"check-label",id:"showUnsetOnly",onInput:X},null,32),t[0]||(t[0]=n("label",{for:"showUnsetOnly"},"Show only not set Endpoint Types",-1))])]),n("div",Te,[v(_e,{label:"Sort by","select-item":c(h).find(a=>a.value===r.sort),callback:Y,items:c(h)},null,8,["select-item","items"])])])]),n("table",Ee,[n("tbody",null,[n("tr",null,[n("td",De,[v(re,{displayed:f.value.length,total:y.value.length},null,8,["displayed","total"])]),n("td",Se,[n("div",Le,[n("button",{class:"btn btn-secondary dropdown-toggle","aria-label":"Set Endpoint Type for all items below",disabled:f.value.length===0,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Set Endpoint Type for all items below ",8,Ue),n("ul",Be,[(o(!0),l(g,null,x(m.indicatorOptions,a=>(o(),l("li",{key:a},[n("a",{href:"#","aria-label":c(b).get(a),onClick:ce(u=>G(a),["prevent"])},d(c(b).get(a)),9,Ie)]))),128))])])])])])]),(o(),N(de,{to:"#modalDisplay"},[w.value?(o(),N(ue,{key:0,heading:"Proceed with bulk operation",body:`Are you sure you want to set ${f.value.length} endpoints to '${c(b).get(k.value)}'?`,onCancel:q,onConfirm:z},null,8,["body"])):T("",!0)])),n("table",{class:"table","aria-label":i.ariaLabel},[n("thead",null,[n("tr",null,[n("th",We,d(m.columnTitle),1),B.value?(o(),l("th",Me,[t[1]||(t[1]=E("Highest monthly throughput ",-1)),D(v(S,{icon:c(L),class:"text-primary"},null,8,["icon"]),[[s,"In the last 12 months"]])])):(o(),l("th",Oe,[t[2]||(t[2]=E("Maximum daily throughput ",-1)),D(v(S,{icon:c(L),class:"text-primary"},null,8,["icon"]),[[s,"In the last 12 months"]])])),n("th",Ne,[t[3]||(t[3]=E("Endpoint Type ",-1)),D(v(S,{icon:c(L),class:"text-primary"},null,8,["icon"]),[[s,"Pick the most correct option"]])])])]),n("tbody",null,[y.value.length===0?(o(),l("tr",Pe,[n("td",Ve,[pe(e.$slots,"nodata",{},void 0,!0)])])):T("",!0),(o(!0),l(g,null,x(f.value,a=>(o(),l("tr",{key:a.name},[n("td",$e,d(a.name),1),B.value?(o(),l("td",Ae,d(a.max_monthly_throughput?a.max_monthly_throughput.toLocaleString():"0"),1)):(o(),l("td",He,d(a.max_daily_throughput.toLocaleString()),1)),n("td",Ke,[n("select",{class:"form-select endpointType format-text",onChange:u=>j(u,a.name)},[m.showEndpointTypePlaceholder?(o(),l("option",qe,"Pick the most appropriate option")):T("",!0),(o(!0),l(g,null,x(m.indicatorOptions,u=>(o(),l("option",{key:u,value:u,selected:(_.value.get(a.name)?.indicator??ee(a))===u},d(c(b).get(u)),9,ze))),128))],40,Re)])]))),128))])],8,Fe)],64)}}}),Ge=ye(Qe,[["__scopeId","data-v-71396cbc"]]);export{A as D,Ge as a};
//# sourceMappingURL=DetectedListView-DdYQVLJ-.js.map
