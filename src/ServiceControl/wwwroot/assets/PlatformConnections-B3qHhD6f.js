import{e as N,by as M,u as V,r as f,s as E,m as l,n as c,q as o,a7 as _,y as t,t as m,z as s,v as r,ao as g,_ as u,ae as I,E as O,a3 as C,a8 as y,U as P}from"./index-tFZp7u44.js";const q={name:"connections"},A={class:"box"},B={class:"row"},R={class:"col-12"},z={novalidate:""},D={class:"row connection"},L={class:"col-7 form-group"},W={for:"monitoringUrl"},$={key:0,class:"failed-validation"},X={class:"col-5 no-side-padding"},j=["disabled"],F={key:0,class:"connection-test connection-testing"},G={key:1,class:"connection-test connection-successful"},H={key:2,class:"connection-test connection-failed"},J={class:"connection-test connection-successful hide save-connection"},K={class:"connection-test connection-failed hide save-connection"},Q=N({__name:"PlatformConnections",setup(Y){const{store:h}=M(),S=h.monitoringConnectionState,p=V(),e=f(p.monitoringUrl),{isMonitoringDisabled:U}=E(p),a=f(!1),d=f(null),v=f(null);p.refresh();async function w(){if(e.value){a.value=!0,!e.value.endsWith("/")&&e.value!=="!"&&(e.value+="/");try{const i=await fetch(e.value+"monitored-endpoints");d.value=i.ok&&i.headers.has("X-Particular-Version")}catch{d.value=!1}finally{a.value=!1}}}function b(){return e.value&&e.value!=="!"}function k(){x(),v.value=!0}function x(){e.value?!e.value.endsWith("/")&&e.value!=="!"&&(e.value+="/"):e.value="!",window.localStorage.removeItem("mu");const i=`?mu=${e.value}`;console.debug("updateConnections - new query string: ",i),window.location.search=i}return(i,n)=>(c(),l("section",q,[o("div",A,[o("div",B,[o("div",R,[o("form",z,[o("div",D,[n[7]||(n[7]=o("h3",null,"ServiceControl Monitoring",-1)),o("div",L,[o("label",W,[n[2]||(n[2]=t(" CONNECTION URL ",-1)),n[3]||(n[3]=o("span",{class:"auxilliary-label"},"(OPTIONAL) (Enter ! to disable monitoring)",-1)),s(S).unableToConnect&&!s(U)?(c(),l("span",$,[r(u,{icon:s(g)},null,8,["icon"]),n[1]||(n[1]=t(" Unable to connect ",-1))])):m("",!0)]),_(o("input",{type:"text",id:"monitoringUrl",name:"monitoringUrl","onUpdate:modelValue":n[0]||(n[0]=T=>e.value=T),class:"form-control",required:""},null,512),[[I,e.value]])]),o("div",X,[o("button",{class:O(["btn btn-default btn-secondary btn-connection-test",{disabled:!b()}]),type:"button",onClick:w,disabled:!b()},"Test",10,j),a.value?(c(),l("span",F,[...n[4]||(n[4]=[o("i",{class:"glyphicon glyphicon-refresh rotate"},null,-1),t("Testing ",-1)])])):m("",!0),d.value===!0&&!a.value?(c(),l("span",G,[r(u,{icon:s(C)},null,8,["icon"]),n[5]||(n[5]=t(" Connection successful ",-1))])):m("",!0),d.value===!1&&!a.value?(c(),l("span",H,[r(u,{icon:s(g)},null,8,["icon"]),n[6]||(n[6]=t(" Connection failed ",-1))])):m("",!0)])]),o("button",{class:"btn btn-primary",type:"button",onClick:k},"Save"),_(o("span",J,[r(u,{icon:s(C)},null,8,["icon"]),n[8]||(n[8]=t(" Connection saved ",-1))],512),[[y,v.value]]),_(o("span",K,[r(u,{icon:s(g)},null,8,["icon"]),n[9]||(n[9]=t(" Unable to save ",-1))],512),[[y,v.value!=null&&!v.value]])])])])])]))}}),nn=P(Q,[["__scopeId","data-v-10908073"]]);export{nn as default};
//# sourceMappingURL=PlatformConnections-B3qHhD6f.js.map
