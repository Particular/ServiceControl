{"version":3,"file":"ConnectionSetupView-D5oAgYeV.js","sources":["../../../../frontend/src/views/throughputreport/setup/ConfigurationCode.vue","../../../../frontend/src/views/throughputreport/setup/ConnectionSetupView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ThroughputConnectionSetting } from \"@/resources/ThroughputConnectionSettings\";\nimport { computed, ref } from \"vue\";\nimport DropDown, { Item } from \"@/components/DropDown.vue\";\nimport CodeEditor from \"@/components/CodeEditor.vue\";\nimport { CodeLanguage } from \"@/components/codeEditorTypes\";\n\nconst props = withDefaults(\n  defineProps<{\n    settings: ThroughputConnectionSetting[];\n    configFileName?: string;\n  }>(),\n  { configFileName: \"ServiceControl.exe.config\" }\n);\n\nconst config = computed(() => {\n  const list: string[] = [];\n  for (const item of props.settings) {\n    list.push(`<!-- ${item.description} -->`);\n    list.push(`<add key=\"${item.name}\" value=\"enter value here\" />`);\n  }\n  return list.join(\"\\n\");\n});\n\nconst bash = computed(() => {\n  const list: string[] = [];\n  for (const item of props.settings) {\n    list.push(`# ${item.description}`);\n    list.push(`export ${item.name.replaceAll(\"/\", \"_\").toUpperCase()}=\"enter value here\"`);\n  }\n  return list.join(\"\\n\");\n});\n\nconst windows = computed(() => {\n  const list: string[] = [];\n  for (const item of props.settings) {\n    list.push(`rem ${item.description}`);\n    list.push(`set ${item.name.replaceAll(\"/\", \"_\").toUpperCase()}=\"enter value here\"`);\n  }\n  return list.join(\"\\n\");\n});\n\nconst powershell = computed(() => {\n  const list: string[] = [];\n  for (const item of props.settings) {\n    list.push(`# ${item.description}`);\n    list.push(`$env:${item.name.replaceAll(\"/\", \"_\").toUpperCase()} = \"enter value here\"`);\n  }\n  return list.join(\"\\n\");\n});\n\nconst languageSelected = ref(\"config\");\nconst codeSelected = computed(() => {\n  switch (languageSelected.value) {\n    case \"bash\":\n      return { code: bash.value, lang: <CodeLanguage>\"shell\" };\n    case \"windows\":\n      return { code: windows.value, lang: <CodeLanguage>\"shell\" };\n    case \"powershell\":\n      return { code: powershell.value, lang: <CodeLanguage>\"shell\" };\n    default:\n      return { code: config.value, lang: <CodeLanguage>\"xml\" };\n  }\n});\n\nconst languages: Item[] = [\n  {\n    text: props.configFileName,\n    value: \"config\",\n  },\n  {\n    text: \"Bash environment variables\",\n    value: \"bash\",\n  },\n  {\n    text: \"Windows environment variables\",\n    value: \"windows\",\n  },\n  {\n    text: \"PowerShell environment variables\",\n    value: \"powershell\",\n  },\n];\n\nfunction languageChanged(item: Item) {\n  languageSelected.value = item.value;\n}\n</script>\n<template>\n  <div>\n    <drop-down label=\"Configuration type\" :select-item=\"languages.find((v) => v.value === languageSelected)\" :callback=\"languageChanged\" :items=\"languages\" />\n  </div>\n  <div class=\"configuration\">\n    <CodeEditor :model-value=\"codeSelected.code\" :language=\"codeSelected.lang\" :show-gutter=\"false\" />\n    <div class=\"instructions\">\n      <slot name=\"configInstructions\" v-if=\"languageSelected === 'config'\"></slot>\n      <slot name=\"environmentVariableInstructions\" v-else></slot>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.configuration {\n  height: 100%;\n}\n.instructions {\n  font-size: 13px;\n  color: #8c8c8c;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from \"vue\";\nimport ThroughputConnectionSettings from \"@/resources/ThroughputConnectionSettings\";\nimport createThroughputClient from \"@/views/throughputreport/throughputClient\";\nimport ConfigurationCode from \"@/views/throughputreport/setup/ConfigurationCode.vue\";\nimport { storeToRefs } from \"pinia\";\nimport FAIcon from \"@/components/FAIcon.vue\";\nimport { faCheck } from \"@fortawesome/free-solid-svg-icons\";\nimport useThroughputStoreAutoRefresh from \"@/composables/useThroughputStoreAutoRefresh\";\nimport { useServiceControlStore } from \"@/stores/ServiceControlStore\";\n\nconst { store } = useThroughputStoreAutoRefresh();\nconst { isBrokerTransport } = storeToRefs(store);\nconst settingsInfo = ref<ThroughputConnectionSettings | null>(null);\n\nconst serviceControlStore = useServiceControlStore();\nconst { isMonitoringEnabled } = storeToRefs(serviceControlStore);\n\nconst throughputClient = createThroughputClient();\n\nonMounted(async () => {\n  settingsInfo.value = await throughputClient.setting();\n});\n\nconst needsConfiguration = computed(() => {\n  const broker = settingsInfo.value?.broker_settings?.length ?? 0;\n  const monitoring = settingsInfo.value?.monitoring_settings?.length ?? 0;\n  const serviceControl = settingsInfo.value?.service_control_settings?.length ?? 0;\n  return broker > 0 || (monitoring > 0 && isMonitoringEnabled.value) || serviceControl > 0;\n});\n</script>\n\n<template>\n  <div class=\"row\">\n    <p v-if=\"needsConfiguration\">\n      In order for ServicePulse to collect usage data from {{ store.transportNameForInstructions() }} you need to configure the below settings.<br />\n      There are two configuration options, as environment variables or directly in the\n      <a href=\"https://docs.particular.net/servicecontrol/creating-config-file\"><code>ServiceControl.exe.config</code></a> file.\n    </p>\n    <p v-else>No further configuration required.</p>\n  </div>\n  <template v-if=\"settingsInfo?.broker_settings.length ?? 0 > 0\">\n    <div class=\"row configuration\">\n      <div class=\"col-12\">\n        <h4>Broker Settings</h4>\n        <p class=\"nogap\">\n          Settings to ensure that usage data is being collected from <a :href=\"store.transportDocsLinkForInstructions()\">{{ store.transportNameForInstructions() }}</a\n          >.<br />\n          Some settings can be automatically configured based on the current transport configuration, so if you have a <FAIcon :icon=\"faCheck\" class=\"text-success\" /> above it means that ServiceControl has successfully connected to\n          {{ store.transportNameForInstructions() }}.\n        </p>\n        <ConfigurationCode :settings=\"settingsInfo?.broker_settings ?? []\">\n          <template #configInstructions>\n            <div>Paste the settings above into the <code>ServiceControl.exe.config</code> file of the ServiceControl Error instance.</div>\n          </template>\n          <template #environmentVariableInstructions>\n            <div>Execute the above instructions in a terminal to set the environment variables, these variables need to be set for the account under which the ServiceControl Error instance is running.</div>\n          </template>\n        </ConfigurationCode>\n      </div>\n    </div>\n  </template>\n  <template v-if=\"!isBrokerTransport\">\n    <template v-if=\"settingsInfo?.service_control_settings.length ?? 0 > 0\">\n      <div class=\"row configuration\">\n        <div class=\"col-12\">\n          <h4>ServiceControl Settings</h4>\n          <p class=\"nogap\">\n            For more information read the\n            <a href=\"https://docs.particular.net/servicecontrol/creating-config-file#usage-reporting-when-using-servicecontrol-licensingcomponentservicecontrolthroughputdataqueue\">LicensingComponent/ServiceControlThroughputDataQueue</a> settings\n            documentation.\n          </p>\n          <ConfigurationCode :settings=\"settingsInfo?.service_control_settings ?? []\">\n            <template #configInstructions>\n              <div>Paste the settings above into the <code>ServiceControl.exe.config</code> file of the ServiceControl Error instance.</div>\n            </template>\n            <template #environmentVariableInstructions>\n              <div>Execute the above instructions in a terminal to set the environment variables , these variables need to be set for the account under which the ServiceControl Error instance is running.</div>\n            </template>\n          </ConfigurationCode>\n        </div>\n      </div>\n    </template>\n    <template v-if=\"isMonitoringEnabled && (settingsInfo?.monitoring_settings.length ?? 0 > 0)\">\n      <div class=\"row configuration\">\n        <div class=\"col-12\">\n          <h4>Monitoring Settings</h4>\n          <p class=\"nogap\">\n            For more information read the\n            <a href=\"https://docs.particular.net/servicecontrol/monitoring-instances/installation/creating-config-file#usage-reporting-monitoringservicecontrolthroughputdataqueue\">Monitoring/ServiceControlThroughputDataQueue</a> settings\n            documentation.\n          </p>\n          <ConfigurationCode :settings=\"settingsInfo?.monitoring_settings ?? []\" configFileName=\"ServiceControl.Monitoring.exe.config\">\n            <template #configInstructions>\n              <div>Paste the settings above into the <code>ServiceControl.Monitoring.exe.config</code> file of the ServiceControl Monitoring instance.</div>\n            </template>\n            <template #environmentVariableInstructions>\n              <div>Execute the above instructions in a terminal to set the environment variables, these variables need to be set for the account under which the ServiceControl Monitoring instance is running.</div>\n            </template>\n          </ConfigurationCode>\n        </div>\n      </div>\n    </template>\n  </template>\n</template>\n<style scoped>\n.configuration {\n  margin-bottom: 15px;\n}\n.nogap {\n  margin-bottom: 0;\n}\n</style>\n"],"names":["props","__props","config","computed","list","item","bash","windows","powershell","languageSelected","ref","codeSelected","languages","languageChanged","_createElementVNode","_createVNode","DropDown","v","_hoisted_1","CodeEditor","_hoisted_2","_renderSlot","_ctx","store","useThroughputStoreAutoRefresh","isBrokerTransport","storeToRefs","settingsInfo","serviceControlStore","useServiceControlStore","isMonitoringEnabled","throughputClient","createThroughputClient","onMounted","needsConfiguration","broker","monitoring","serviceControl","_createElementBlock","_createTextVNode","_toDisplayString","_unref","_openBlock","_hoisted_4","_hoisted_5","_cache","_hoisted_6","_hoisted_7","FAIcon","faCheck","ConfigurationCode","_Fragment","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11"],"mappings":"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"}